---
import { Image } from 'astro:assets';

const { brand, hero, settings } = Astro.props;

// 1. Grab all images from the optimized assets folder
const images = import.meta.glob('/src/assets/images/*.{jpeg,jpg,png,gif,webp}');

// 2. SELF-HEALING LOGIC: Generate the filename to match the script's output
// This removes apostrophes and replaces spaces/special chars with dashes
const slug = brand.name.toLowerCase()
    .replace(/'/g, '') 
    .replace(/[^a-z0-9]/g, '-');

const expectedFilename = `${slug}-hero.jpg`;
const cleanPath = `/src/assets/images/${expectedFilename}`;

// 3. Check if the image exists in the assets folder
const hasImage = images[cleanPath];

// DEBUG: Shows in your terminal if the match fails
if (!hasImage) {
  console.log(`ðŸ”Ž Hero component searching for: ${cleanPath}`);
  console.log(`ðŸ“‚ Files actually in folder:`, Object.keys(images));
}
---

<section class="relative min-h-[85vh] flex items-center justify-center overflow-hidden bg-[var(--bg-color)]">
  
  <div class="absolute inset-0 z-0">
    {hasImage ? (
      <Image 
        src={images[cleanPath]()} 
        alt={hero.image.alt || brand.name} 
        width={1600} 
        height={900} 
        class="w-full h-full object-cover opacity-30"
        loading="eager"
      />
    ) : (
      /* Fallback Gradient if image is missing */
      <div class="w-full h-full opacity-20 bg-gradient-to-br from-[var(--accent)] to-transparent"></div>
    )}
  </div>

  <div class="container relative z-10 px-6 mx-auto text-center">
    <p class="mb-6 text-sm font-bold tracking-[0.3em] uppercase text-[var(--accent)]">
      {brand.name}
    </p>
    
    <h1 class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl font-black uppercase tracking-tighter leading-[0.9] text-[var(--text-primary)] mb-6">
        {hero.headline}
    </h1>

    <p class="max-w-2xl mx-auto mb-12 text-xl md:text-2xl text-[var(--text-secondary)] leading-relaxed">
      {hero.subtext}
    </p>

    <div class="flex flex-col items-center gap-8">
      <a href={settings.cta_link} class="bg-[var(--accent)] px-12 py-5 text-xs font-bold uppercase tracking-[0.2em] transition-all hover:scale-105 rounded-[var(--radius)] inline-block text-black">
        {settings.cta_text}
      </a>
      
      {brand.objection_handle && (
        <span class="text-[10px] uppercase tracking-[0.25em] opacity-50 flex items-center gap-4 text-[var(--text-primary)]">
          <span class="w-8 h-[1px] bg-[var(--accent)] opacity-40"></span>
          {brand.objection_handle}
          <span class="w-8 h-[1px] bg-[var(--accent)] opacity-40"></span>
        </span>
      )}
    </div>
  </div>
</section>